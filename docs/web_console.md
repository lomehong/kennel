# Web控制台使用指南

## 概述

Web控制台是应用框架的一个重要组件，提供了一个基于Web的界面，用于管理和监控框架的运行状态。它允许用户通过浏览器查看框架的各种指标、管理插件、查看和修改配置等。

## 功能特点

Web控制台提供以下核心功能：

1. **插件管理**：显示所有已加载插件列表，支持启用/禁用/配置插件
2. **指标监控**：实时展示通讯模块的各项指标（连接状态、消息统计、延迟等）
3. **系统监控**：显示框架运行状态、资源使用情况、错误日志等
4. **配置管理**：允许查看和修改框架配置

## 安装和配置

Web控制台是应用框架的一个内置组件，无需单独安装。默认情况下，Web控制台已启用，并监听在`8088`端口。

### 配置选项

Web控制台支持以下配置选项，可以在配置文件中进行设置：

```yaml
web_console:
  enabled: true                # 是否启用Web控制台
  host: "0.0.0.0"              # Web控制台监听地址
  port: 8088                   # Web控制台监听端口
  enable_https: false          # 是否启用HTTPS
  cert_file: ""                # HTTPS证书文件
  key_file: ""                 # HTTPS私钥文件
  enable_auth: true            # 是否启用认证
  username: "admin"            # 认证用户名
  password: "admin"            # 认证密码
  session_timeout: "24h"       # 会话超时时间
  static_dir: "./web/dist"     # 静态文件目录
  log_level: "info"            # 日志级别
```

## 访问Web控制台

启动应用框架后，可以通过浏览器访问Web控制台：

```
http://localhost:8088
```

如果启用了认证，需要输入用户名和密码进行登录。默认用户名和密码分别为`admin`和`admin`。

## 使用指南

### 仪表盘

仪表盘页面提供了框架运行状态的概览，包括：

- 系统状态：显示框架版本、运行时间等信息
- 插件状态：显示已加载插件数量、已启用/禁用插件数量等
- 通讯状态：显示通讯模块的连接状态、消息统计等
- 系统资源：显示CPU使用率、内存使用率、磁盘使用率等
- 最近事件：显示最近发生的系统事件

### 插件管理

插件管理页面提供了对插件的管理功能，包括：

- 查看所有已加载插件列表
- 启用/禁用插件
- 查看插件详细信息
- 配置插件参数
- 查看插件日志

#### 插件详情

点击插件列表中的插件名称或详情按钮，可以查看插件的详细信息，包括：

- 基本信息：显示插件ID、名称、版本、描述等
- 配置：查看和修改插件配置
- 日志：查看插件日志

### 指标监控

指标监控页面提供了对通讯模块和系统指标的监控功能，包括：

#### 通讯指标

- 连接状态：显示当前连接状态、连接次数、重连次数等
- 消息统计：显示发送/接收消息数量、字节数等
- 延迟指标：显示平均延迟、最小/最大延迟等
- 压缩指标：显示压缩消息数量、压缩率等
- 心跳指标：显示心跳消息数量、最后心跳时间等

#### 系统指标

- CPU使用率：显示CPU使用率、核心数等
- 内存使用：显示内存使用率、已用/总内存等
- 运行时指标：显示Goroutines数量、堆分配等

### 系统监控

系统监控页面提供了对系统状态和资源的监控功能，包括：

- 系统状态：显示主机信息、框架信息、运行时信息等
- 资源使用：显示CPU使用率、内存使用、磁盘使用等
- 系统日志：显示系统日志
- 系统事件：显示系统事件

### 配置管理

配置管理页面提供了对框架配置的管理功能，包括：

- 查看当前配置
- 修改配置
- 保存配置
- 重置配置

## 安全性

Web控制台采用以下安全措施：

1. **认证**：支持基本认证，确保只有授权用户才能访问Web控制台
2. **HTTPS**：支持HTTPS，确保通信安全
3. **CSRF保护**：防止跨站请求伪造攻击
4. **请求限制**：限制请求频率，防止DoS攻击

## 故障排除

### 无法访问Web控制台

1. 确认应用框架已启动
2. 确认Web控制台已启用（`web_console.enabled`设置为`true`）
3. 确认Web控制台端口未被占用
4. 检查防火墙设置，确保端口已开放

### 认证失败

1. 确认使用了正确的用户名和密码
2. 如果忘记密码，可以在配置文件中重置密码

### 配置保存失败

1. 确认配置格式正确（JSON格式）
2. 确认配置文件有写入权限

## 开发和扩展

Web控制台采用前后端分离的架构，后端使用Go语言实现，前端使用React和Ant Design实现。

### 后端开发

后端代码位于`pkg/webconsole`目录下，主要包括：

- `console.go`：Web控制台核心代码
- `config.go`：Web控制台配置
- `middleware.go`：中间件
- `*_api.go`：API实现

### 前端开发

前端代码位于`web`目录下，主要包括：

- `src/pages`：页面组件
- `src/components`：通用组件
- `src/services`：API服务
- `src/utils`：工具函数

#### 构建前端

```bash
cd web
npm install
npm run build
```

构建后的文件将输出到`web/dist`目录，应用框架将自动加载这些文件。
